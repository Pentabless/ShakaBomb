//==============================================================================================
/// File Name	: GoalController.cs
/// Summary		: ゴール
//==============================================================================================
using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using System;
using Common;
//==============================================================================================
public class GoalController : MonoBehaviour
{
    //------------------------------------------------------------------------------------------
    // member variable
    //------------------------------------------------------------------------------------------
    [SerializeField]
    PlayDirector playDirector;
    PlayBGM bgm;

    bool once = false;  // 一度だけイベントを通知するための変数

	//------------------------------------------------------------------------------------------
    // Awake
	//------------------------------------------------------------------------------------------
    private void Awake()
    {
        
    }

	//------------------------------------------------------------------------------------------
    // Start
	//------------------------------------------------------------------------------------------
    private void Start()
    {
        bgm = GameObject.Find("PlaySceneBgm").GetComponent<PlayBGM>();
        if(!bgm)
        {
            Debug.Log("BGMをアタッチしてください");
        }
    }

	//------------------------------------------------------------------------------------------
    // Update
	//------------------------------------------------------------------------------------------
	private void Update()
    {
        
    }

    //------------------------------------------------------------------------------------------
    // ゴールにプレイヤーが触れた
    //------------------------------------------------------------------------------------------
    private void OnTriggerEnter2D(Collider2D col)
    {
        if (once)
        {
            return;
        }

        if (col.tag == Player.NAME)
        {
            playDirector.Goal();
            bgm.GoalEvent();
            once = true;
        }
    }
}
